(()=>{"use strict";var a={};a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var w={};a.r(w),a.d(w,{createProgram:()=>Y});var h={};a.r(h),a.d(h,{initCreate:()=>V});const P=require("commander"),k=require("chalk");var p=a.n(k);const y=(e,t)=>{const r=e.toString();return r.length>=t?r:new Array(t-r.length).fill(0).join("")+r},l=()=>{const e=new Date;return p().grey(`${y(e.getHours(),2)}:${y(e.getMinutes(),2)}:${y(e.getSeconds(),2)}.${y(e.getMilliseconds(),3)}`)};function j(e,t){console.log(l(),`\u{1F680} ${p().blue(e)}`,t||"")}function z(e,t){console.log(l(),`${chalk.bgBlue("\u2727")} ${chalk.blue(e)}`,t||"")}function D(e,t){console.log(l(),`\u2705 ${p().green(e)}`,t||"")}function x(e,t){console.log(l(),`\u274C ${p().red(e)}`,t||"")}function F(...e){console.error(l(),...e.map(t=>p().red(t)))}function G(...e){console.warn(l(),...e.map(t=>chalk.yellow(t)))}function M(...e){console.log(l(),...e)}function J(...e){console.info(l(),...e.map(t=>chalk.italic(t)))}function L(e,t="yyyy-MM-dd hh:mm:ss"){let r=t;const n={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};/(y+)/.test(r)&&(r=r.replace(RegExp.$1,`${e.getFullYear()}`.substr(4-RegExp.$1.length)));for(const u in n)new RegExp(`(${u})`).test(r)&&(r=r.replace(RegExp.$1,RegExp.$1.length===1?n[u]:`00${n[u]}`.substr(`${n[u]}`.length)));return r}var O=(e,t,r)=>new Promise((n,u)=>{var c=o=>{try{f(r.next(o))}catch(m){u(m)}},i=o=>{try{f(r.throw(o))}catch(m){u(m)}},f=o=>o.done?n(o.value):Promise.resolve(o.value).then(c,i);f((r=r.apply(e,t)).next())});function C(e=0){setTimeout(()=>{process.exit(e)},100)}function A(e,t){return O(this,null,function*(){try{yield e()}catch(r){F(r),t&&(yield t()),C(-1)}})}var d=(e=>(e.fe="fe",e.be="be",e))(d||{}),_=(e=>(e.umiStarter="umi-starter",e.umiPwa="umi-pwa",e))(_||{}),S=(e=>(e.nestStarter="nest-starter",e))(S||{});const s=require("fs"),E=require("path"),N=(e,t,r)=>{const n=path.join(t,r);fs.writeFile(n,e,u=>{u&&error(u.message)})},b=e=>{const t=s.readdirSync(e);for(const r of t){const n=E.join(e,r);s.statSync(n).isDirectory()?b(n):s.unlinkSync(n)}s.rmdirSync(e)},g=(e,t)=>{s.existsSync(t)&&b(t),s.mkdirSync(t,{recursive:!0});const r=s.readdirSync(e);for(const n of r){const u=E.join(e,n),c=E.join(t,n);s.statSync(u).isDirectory()?g(u,c):s.copyFileSync(u,c)}},$=(e,t)=>{v(e,t)},q=(e,t)=>{const r=s.readFileSync(e,"utf8"),n=Object.keys(t),u=r.replace(/{{\s*@ti\.inject="(\w+)"\s*}}/g,(c,i)=>n.includes(i)?t[i]:c);s.writeFileSync(e,u)},v=(e,t)=>{s.readdirSync(e).forEach(n=>{const u=E.join(e,n),c=s.statSync(u);c.isDirectory()?v(u,t):c.isFile()&&q(u,t)})},R=(e,t)=>{const{name:r}=t,n=`${process.cwd()}/${r}`;switch(e){case _.umiStarter:H(r),$(n,t);break;case _.umiPwa:T(r),$(n,t);break;default:throw new Error("\u4E0D\u5B58\u5728\u5BF9\u5E94\u6846\u67B6")}},H=e=>{const t=`${__dirname}/template/umi-starter`,r=`${process.cwd()}/${e}`;g(t,r)},T=e=>{const t=`${__dirname}/template/umi-pwa`,r=`${process.cwd()}/${e}`;g(t,r)},U=(e,t)=>{const{name:r}=t,n=`${process.cwd()}/${r}`;switch(e){case S.nestStarter:I(r),$(n,t);break;default:throw new Error("\u4E0D\u5B58\u5728\u5BF9\u5E94\u6846\u67B6")}},I=e=>{const t=`${__dirname}/template/nest-starter`,r=`${process.cwd()}/${e}`;g(t,r)};var B=(e,t,r)=>new Promise((n,u)=>{var c=o=>{try{f(r.next(o))}catch(m){u(m)}},i=o=>{try{f(r.throw(o))}catch(m){u(m)}},f=o=>o.done?n(o.value):Promise.resolve(o.value).then(c,i);f((r=r.apply(e,t)).next())});function V(e){e.command("create").description("\u751F\u6210\u524D\u540E\u7AEF\u6846\u67B6\u4EE3\u7801").alias("c").option("-t, --type <type>","\u6846\u67B6\u7C7B\u578B").option("-k, --kit <kit>","\u6846\u67B6\u9884\u8BBE").option("-n, --name <name>","\u9879\u76EE\u540D\u79F0").action((t,r)=>B(this,null,function*(){const{_optionValues:n}=r,{type:u,kit:c,name:i}=n;j("\u6B63\u5728\u542F\u52A8\u751F\u6210"),yield A(()=>B(this,null,function*(){if(!u)throw new Error("\u9700\u8981\u6307\u5B9A\u6846\u67B6\u7C7B\u578B");if(!c)throw new Error("\u9700\u8981\u6307\u5B9A\u6846\u67B6\u9884\u8BBE");if(!i)throw new Error("\u9700\u8981\u6307\u5B9A\u9879\u76EE\u540D\u79F0");switch(M(`\u5F00\u59CB\u751F\u6210 ${i} \u9879\u76EE\uFF0C\u4F7F\u7528 ${u} ${c} \u6846\u67B6`),u){case d.fe:R(c,{name:i});break;case d.be:U(c,{name:i});break;default:throw new Error("\u4E0D\u5B58\u5728\u5BF9\u5E94\u7C7B\u578B")}D("\u6846\u67B6\u4EE3\u7801\u751F\u6210\u6210\u529F")}),()=>B(this,null,function*(){x("\u6846\u67B6\u4EE3\u7801\u751F\u6210\u5931\u8D25")}))})).addHelpText("after",`
Examples:
  $ ti create -t <type> -k <kit> -n <name>
  $ ti create -t fe -k umi-starter|umi-pwa name: \u751F\u6210\u524D\u7AEF\u6846\u67B6\u4EE3\u7801
  $ ti create -t be -k ...: \u751F\u6210\u540E\u7AEF\u6846\u67B6\u4EE3\u7801

        `).showHelpAfterError()}function Y(){const e=new P.Command;return e.action(()=>{e.help()}),Object.keys(h).forEach(t=>{try{h[t](e)}catch(r){F(`\u6307\u4EE4\u521D\u59CB\u5316\u5931\u8D25: ${r.message}`)}}),e}module.exports=w})();
